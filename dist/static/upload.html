<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>上传附件 - Dimension Zero</title>
  <style>
    body { background: #181926; color: #fff; font-family: sans-serif; }
    .box { margin: 100px auto; max-width: 400px; background: #23233a; padding: 36px; border-radius: 18px; }
    input[type=file] { width: 100%; background: #222; color: #fff; margin-bottom: 18px; }
    button { padding: 10px 32px; background: #10b981; border: none; color: #fff; border-radius: 8px; font-size: 18px; cursor: pointer; }
    .result { margin-top: 24px; }
    .filelink { color: #2dd4bf; word-break: break-all; }
  </style>
</head>
<body>
  <div class="box">
    <h2>上传附件</h2>
    <form id="uploadForm">
      <input type="file" name="files" id="fileInput" multiple>
      <input type="text" name="dir" id="dirInput" placeholder="目标子目录(如 posts/serpent-archive/gallery )">
      <button type="submit">上传</button>
    </form>
    <div class="result" id="result"></div>
  </div>
  <script>
    document.getElementById('uploadForm').onsubmit = async function(e){
      e.preventDefault();
      const files = document.getElementById('fileInput').files;
      const dir = document.getElementById('dirInput').value.trim();
      if(!files.length) return alert('请选择要上传的文件');
      const fd = new FormData();
      for(let f of files) fd.append('files', f);
      if(dir) fd.append('dir', dir);
      const res = await fetch('/api/upload', { method: 'POST', body: fd });
      const data = await res.json();
      if(data.success) {
        document.getElementById('result').innerHTML =
          data.files.map(f => `<div>已上传: <a class="filelink" href="${f.url}" target="_blank">${f.url}</a></div>`).join('');
      } else {
        document.getElementById('result').textContent = '上传失败';
      }
    }
  </script>
</body>
</html>